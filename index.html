<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Meta Media Hub ‚Äî Image Suite</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="app-wrap">

    <!-- TOP BAR -->
    <header class="topbar">
      <div class="brand">
        <div class="logo">MM</div>
        <div>
          <h1>Meta Media Hub</h1>
          <span class="tagline">Internal image toolkit for META e-learning</span>
        </div>
      </div>

      <div class="right">
        <button id="themeToggle" class="theme-toggle" title="Toggle light/dark">üåô</button>
        <span id="statusText" class="status">Locked</span>
        <button id="aboutBtn" class="about-btn" title="About this tool">i</button>
      </div>
    </header>

    <!-- PASSWORD MODAL -->
    <div id="pwModal" class="modal" style="display:flex">
      <div class="modal-panel pw-panel">
        <h2>Enter Password</h2>
        <p class="small">Unlock the Meta Media Hub</p>
        <input id="pwInput" class="input" type="password" placeholder="Password" />
        <button id="pwBtn" class="btn primary full">Unlock</button>
        <p id="pwMsg" class="error"></p>
      </div>
    </div>

    <!-- HOME (TWO TOOLS) -->
    <section id="home" class="home-section" style="display:none">
      <div class="tool-card" id="btnImage">
        <div class="icon">üñºÔ∏è</div>
        <h3>Image Tools</h3>
        <p>Resize ‚Ä¢ Smart Center ‚Ä¢ Human Detection ‚Ä¢ ZIP export</p>
      </div>

      <div class="tool-card" id="btnEnhancer">
        <div class="icon">‚ú®</div>
        <h3>AI Image Enhancer</h3>
        <p>Upscale ‚Ä¢ Sharpen ‚Ä¢ Denoise ‚Ä¢ HDR ‚Ä¢ Text clarity</p>
      </div>
    </section>

    <!-- IMAGE RESIZER SECTION -->
    <section id="imageSection" class="section" style="display:none">

      <div class="section-header">
        <div>
          <h2>Image Tools</h2>
          <p class="subtitle">Batch resize with smart human detection & manual focus.</p>
        </div>
        <button id="backHomeFromImage" class="back-btn">‚Üê Home</button>
      </div>

      <div id="smartBanner" class="smart-banner off" style="display:none">
        <div id="bannerIcon" class="s-icon">‚ö™</div>
        <div id="bannerText" class="s-text">
          Smart Human Detection status will appear here after scanning.
        </div>
      </div>

      <div class="panel">
        <div id="dropImage" class="dropzone">
          Click or drag & drop images here (multiple)
        </div>
        <input id="imageInput" type="file" accept="image/*" multiple>

        <div id="imageFileList" class="file-list">No files uploaded.</div>

        <div class="two-input">
          <input id="imgWidth" class="input" type="number" placeholder="Width (px)">
          <input id="imgHeight" class="input" type="number" placeholder="Height (px)">
        </div>

        <div class="controls">
          <div class="mini-control">
            <label>Quality</label>
            <div class="help-tip" data-tip="Higher quality = better clarity but heavier file size. 90% works well for most LMS assets.">?</div>
          </div>
          <input id="imgQuality" type="range" min="60" max="100" value="90">
          <span id="imgQualityVal">90%</span>

          <div class="flex-spacer"></div>

          <div id="imgAiToggle" class="ai-switch" title="Smart Human Detection">
            <div class="track"><div class="ball"></div></div>
            <span class="label-off">Smart Detection: OFF</span>
            <span class="label-on">Smart Detection: ON</span>
          </div>
        </div>

        <div class="btn-row">
          <button id="imgPreviewBtn" class="btn ghost">Preview First</button>
          <button id="focusBtn" class="btn ghost">Manual Focus</button>
          <button id="imgProcessBtn" class="btn primary">Process & Download ZIP</button>
        </div>

        <div class="progress"><div id="imgProgress" class="bar"></div></div>
        <p id="imgStatus" class="status-text">Ready.</p>
      </div>

      <footer class="footer">
        Created by Mukesh Yadav ‚Ä¢ META E-learning Team
      </footer>
    </section>

    <!-- AI IMAGE ENHANCER SECTION -->
    <section id="enhancerSection" class="section" style="display:none">
      <div class="section-header">
        <div>
          <h2>AI Image Enhancer</h2>
          <p class="subtitle">Improve quality: upscale, sharpen, denoise, HDR & text clarity ‚Äî right in the browser.</p>
        </div>
        <button id="backHomeFromEnhancer" class="back-btn">‚Üê Home</button>
      </div>

      <div class="panel enhancer-layout">
        <div class="enh-left">
          <h3 class="panel-title">Upload Image</h3>
          <div id="dropEnhance" class="dropzone">
            Click or drag & drop a single image
          </div>
          <input id="enhanceInput" type="file" accept="image/*">
          <div id="enhFileInfo" class="file-list small-file">No image selected.</div>

          <p class="small-muted">
            Ideal for portraits, key visuals, LMS screenshots, thumbnails and hero images.
          </p>
        </div>

        <div class="enh-right">
          <h3 class="panel-title">Enhancement Options</h3>
          <div class="ai-panel">
            <div class="ai-panel-header">
              <span class="label">Smart Enhancements (processed locally)</span>
              <div class="help-tip" data-tip="These processors work directly in your browser using Canvas. No upload, no server, safe for internal projects.">?</div>
            </div>

            <div class="ai-options">
              <label class="ai-option">
                <input type="checkbox" id="enhUpscale2x">
                <span>Upscale √ó2 (Super Resolution-lite)</span>
                <div class="help-tip" data-tip="Enlarges the image 2√ó with high-quality smoothing + edge boost. Good for slightly low-res images.">?</div>
              </label>
              <label class="ai-option">
                <input type="checkbox" id="enhUpscale4x">
                <span>Upscale √ó4 (Deep Detail)</span>
                <div class="help-tip" data-tip="Massive enlargement with extra sharpening. Best for hero shots / thumbnails. Heavier processing.">?</div>
              </label>
              <label class="ai-option">
                <input type="checkbox" id="enhFaceEnhance">
                <span>Boost Faces & Detail</span>
                <div class="help-tip" data-tip="Unsharp mask style enhancement ‚Äî sharpens edges and facial details without overdoing it.">?</div>
              </label>
              <label class="ai-option">
                <input type="checkbox" id="enhDenoise">
                <span>Denoise & Smooth</span>
                <div class="help-tip" data-tip="Softens grain / compression noise before sharpening, especially for low-quality JPEGs.">?</div>
              </label>

              <label class="ai-option">
                <input type="checkbox" id="enhOCR">
                <span>Text / OCR Clarity</span>
                <div class="help-tip" data-tip="Makes UI / text screenshots crisper by boosting local contrast.">?</div>
              </label>
              <label class="ai-option">
                <input type="checkbox" id="enhHDR">
                <span>HDR Boost (Shadows & Highlights)</span>
                <div class="help-tip" data-tip="Lifts shadows and gently compresses highlights so faces & UI are easier to read.">?</div>
              </label>
              <label class="ai-option">
                <input type="checkbox" id="enhHide">
                <span>Object Hide / Privacy Blur</span>
                <div class="help-tip" data-tip="Blur a selected rectangle (face, ID, logo) without touching the rest of the image.">?</div>
              </label>
            </div>

            <div class="btn-row small-row">
              <button id="hideAreaBtn" class="btn ghost">Set Hide Area</button>
            </div>

            <p class="ai-note">
              These filters gently improve clarity, contrast and reduce noise using on-device processing.
              No server, no upload.
            </p>
          </div>

          <div class="two-input">
            <div class="mini-control">
              <label class="small-label">Output Quality</label>
              <div class="help-tip" data-tip="Controls JPEG export quality. 92% is a sweet spot between clarity and file size.">?</div>
              <input id="enhQuality" type="range" min="70" max="100" value="92">
              <span id="enhQualityVal" class="mini-val">92%</span>
            </div>
          </div>

          <div class="btn-row">
            <button id="enhPreviewBtn" class="btn ghost">Preview (Before / After)</button>
            <button id="enhRunBtn" class="btn primary">Enhance & Download</button>
          </div>

          <div class="progress"><div id="enhProgress" class="bar"></div></div>
          <p id="enhStatus" class="status-text">Waiting for image.</p>

          <!-- ANNOTATION AREA -->
          <div class="annot-wrap">
            <div class="annot-toolbar">
              <span class="annot-label">Annotate Output</span>
              <button id="toolRect"  class="annot-btn active" title="Rectangle highlight">‚ñ¢</button>
              <button id="toolArrow" class="annot-btn" title="Arrow">‚û§</button>
              <button id="toolText"  class="annot-btn" title="Text label">T</button>
              <button id="annotClear" class="annot-btn" title="Clear annotations">‚úï</button>
              <button id="annotApply" class="btn primary annot-apply">Apply to Image</button>
            </div>
            <div class="annot-area">
              <canvas id="annotCanvas"></canvas>
              <div class="annot-empty" id="annotEmptyMsg">Run Enhance once to load image for annotation.</div>
            </div>
            <p class="small-muted">
              Annotations are applied on top of the enhanced version and included in the final download (rectangles, arrows, labels).
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- PREVIEW MODAL (shared) -->
    <div id="previewModal" class="modal">
      <div class="modal-panel large">
        <div class="modal-head">
          <h3 id="previewTitle">Preview</h3>
          <button id="closePreview" class="close-btn">‚úï</button>
        </div>
        <p id="previewInfo" class="small-muted"></p>

        <div id="previewArea" class="preview-area">
          <img id="beforeImg">
          <div id="afterLayer" class="after-layer">
            <img id="afterImg">
          </div>
          <div id="handle" class="handle"></div>
        </div>
      </div>
    </div>

    <!-- MANUAL FOCUS MODAL (resizer) -->
    <div id="focusModal" class="modal">
      <div class="modal-panel large">
        <div class="modal-head">
          <h3>Manual Focus</h3>
          <button id="closeFocus" class="close-btn">‚úï</button>
        </div>

        <select id="focusSelect" class="input"></select>

        <div id="focusCanvas" class="focus-canvas">
          <img id="focusPreview">
          <div id="focusRect" class="focus-rect">
            <div class="focus-handle"></div>
          </div>
        </div>

        <div class="btn-row">
          <button id="saveFocus" class="btn primary">Save Focus</button>
          <button id="clearFocus" class="btn ghost">Clear</button>
        </div>
      </div>
    </div>

    <!-- OBJECT HIDE MODAL (for enhancer) -->
    <div id="hideModal" class="modal">
      <div class="modal-panel large">
        <div class="modal-head">
          <h3>Object Hide Area</h3>
          <button id="closeHide" class="close-btn">‚úï</button>
        </div>
        <p class="small-muted">
          Drag the rectangle over the area you want to blur (logo, face, ID, etc.).
        </p>

        <div id="hideCanvas" class="focus-canvas">
          <img id="hidePreview">
          <div id="hideRect" class="focus-rect">
            <div class="focus-handle"></div>
          </div>
        </div>

        <div class="btn-row">
          <button id="saveHide" class="btn primary">Save Hide Area</button>
          <button id="clearHide" class="btn ghost">Clear</button>
        </div>
      </div>
    </div>

    <!-- ABOUT MODAL -->
    <div id="aboutModal" class="modal">
      <div class="modal-panel about-panel">
        <div class="modal-head">
          <div class="about-head">
            <span class="about-pill">About</span>
            <h3>Meta Media Hub</h3>
            <p>Internal image toolkit for fast, safe e-learning & media production.</p>
          </div>
          <button id="closeAbout" class="close-btn">‚úï</button>
        </div>

        <div class="about-grid">
          <div class="about-col">
            <h4>What it does</h4>
            <ul>
              <li>Batch resize with smart human detection</li>
              <li>Manual focus cropping for key subjects</li>
              <li>AI-style enhancement (upscale, sharpen, denoise)</li>
              <li>ZIP export for quick LMS uploads</li>
            </ul>
          </div>

          <div class="about-col">
            <h4>Safety & workflow</h4>
            <ul>
              <li>All processing stays inside your browser</li>
              <li>No uploads, no cloud, safe for confidential assets</li>
              <li>Designed for META e-learning & media teams</li>
              <li>Ideal for ILTs, WBTs, storyboards & thumbnails</li>
            </ul>
          </div>
        </div>

        <div class="about-footer-row">
          <span class="about-meta">v1.7 ‚Ä¢ Designed & built by <strong>Mukesh Yadav</strong></span>
          <span class="about-meta">Contact: META E-learning / Media team</span>
        </div>
      </div>
    </div>
  </div>

  <!-- LIBRARIES -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.21.0/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.2.2/dist/coco-ssd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

  <!-- MAIN SCRIPT -->
  <script src="script_v.js"></script>
</body>
</html>
